<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏûêÍ∏∞ÏÑúÏÇ¨ Í∏∞Î∞ò ÏπòÏú† ÏõåÌÅ¨ÏãúÌä∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            font-style: italic;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            border-left: 5px solid #667eea;
        }

        .section h2 {
            color: #667eea;
            font-size: 1.8rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h2::before {
            content: "üîπ";
            font-size: 1.5rem;
        }

        .section h3 {
            color: #555;
            font-size: 1.3rem;
            margin: 20px 0 15px 0;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .highlight {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
            font-style: italic;
        }

        .quote-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #2196f3;
            margin: 15px 0;
            font-style: italic;
        }

                 .checkbox-group {
             display: flex;
             gap: 15px;
             margin: 10px 0;
             flex-wrap: wrap;
         }

                   .likert-scale {
              display: flex;
              flex-direction: column;
              gap: 8px;
              margin: 10px 0;
          }

          .likert-scale-horizontal {
              display: flex;
              flex-direction: row;
              gap: 15px;
              margin: 10px 0;
              flex-wrap: wrap;
              justify-content: space-between;
          }

         .likert-item {
             display: flex;
             align-items: center;
             gap: 8px;
             cursor: pointer;
             padding: 4px 8px;
             border-radius: 4px;
             transition: background-color 0.2s ease;
         }

         .likert-item:hover {
             background-color: #f0f0f0;
         }

         .likert-item input[type="radio"] {
             width: 16px;
             height: 16px;
             cursor: pointer;
         }

         .likert-item label {
             cursor: pointer;
             font-weight: 500;
             font-size: 0.9rem;
         }

         .add-character-btn {
             background: #28a745;
             color: white;
             border: none;
             padding: 8px 16px;
             border-radius: 20px;
             cursor: pointer;
             font-size: 0.9rem;
             margin: 10px 0;
             transition: all 0.3s ease;
         }

         .add-character-btn:hover {
             background: #218838;
             transform: translateY(-1px);
         }

         .remove-character-btn {
             background: #dc3545;
             color: white;
             border: none;
             padding: 4px 8px;
             border-radius: 12px;
             cursor: pointer;
             font-size: 0.8rem;
             margin-left: 10px;
             transition: all 0.3s ease;
         }

         .remove-character-btn:hover {
             background: #c82333;
         }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .checkbox-item input[type="radio"], .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-item label {
            cursor: pointer;
            font-weight: 500;
        }

        input[type="text"], textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
            background: white;
        }

        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }
        .editable-cell textarea {
            width: 100%;
            min-height: 60px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 8px;
            font-family: inherit;
            font-size: 0.95rem;
        }

        .editable-cell {
            position: relative;
        }

        .editable-cell input {
            width: 100%;
            border: none;
            background: transparent;
            font-size: inherit;
            padding: 0;
        }

        .editable-cell input:focus {
            outline: none;
            background: #f8f9fa;
            border-radius: 4px;
            padding: 2px 4px;
        }

        .status-indicator {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 5px;
        }

        .status-support { background: #d4edda; color: #155724; }
        .status-hostile { background: #f8d7da; color: #721c24; }
        .status-mixed { background: #fff3cd; color: #856404; }

        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .print-button:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .save-button {
            position: fixed;
            top: 20px;
            right: 120px;
            background: #4caf50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .save-button:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .load-button {
            position: fixed;
            top: 20px;
            right: 220px;
            background: #2196f3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

                 .load-button:hover {
             background: #1976d2;
             transform: translateY(-2px);
         }

         .circle-container {
             position: relative;
             width: 600px;
             height: 600px;
             margin: 40px auto;
         }
         
         .circle {
             position: absolute;
             border-radius: 50%;
             border: 2px solid #aaa;
             left: 50%;
             top: 50%;
             transform: translate(-50%, -50%);
         }
         
         .inner-circle { width: 200px; height: 200px; }
         .middle-circle { width: 360px; height: 360px; }
         .outer-circle { width: 520px; height: 520px; }

         .label {
             position: absolute;
             font-weight: bold;
             background: white;
             padding: 3px 8px;
         }
         
         .label-inner { top: 50%; left: 50%; transform: translate(-50%, -50%); }
         .label-middle { top: 15%; left: 50%; transform: translate(-50%, -50%); }
         .label-outer { top: -2%; left: 50%; transform: translate(-50%, -50%); }

         .conflict-section {
             width: 90%;
             max-width: 600px;
             margin: 30px auto;
             padding: 20px;
             border: 1px solid #ccc;
             border-radius: 10px;
             background: #f9f9f9;
         }

         .conflict-section h3 {
             margin-bottom: 10px;
             color: #333;
         }

         .conflict-section input[type="text"] {
             width: 95%;
             padding: 8px;
             margin: 6px 0 12px;
             border: 1px solid #ccc;
             border-radius: 5px;
         }

         .radio-group {
             display: flex;
             justify-content: space-around;
             flex-wrap: wrap;
         }

         .radio-group label {
             margin: 5px;
         }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .content {
                padding: 20px;
            }

            .section {
                padding: 20px;
            }

            table {
                font-size: 0.9rem;
            }

            th, td {
                padding: 10px;
            }

            .checkbox-group {
                flex-direction: column;
                gap: 10px;
            }

            .print-button, .save-button, .load-button {
                position: static;
                margin: 10px;
                display: inline-block;
            }
        }

        @media print {
            .print-button, .save-button, .load-button {
                display: none;
            }
            
            body {
                background: white;
            }
            
            .container {
                box-shadow: none;
                border-radius: 0;
            }
        }
    </style>
</head>
<body>
    <button class="print-button" onclick="window.print()">üñ®Ô∏è Ïù∏ÏáÑ</button>
    <button class="save-button" onclick="saveData()">üíæ Ï†ÄÏû•</button>
    <button class="load-button" onclick="loadData()">üìÇ Î∂àÎü¨Ïò§Í∏∞</button>
    
    <div class="container">
        <div class="header">
            <h1>ÏûêÍ∏∞ÏÑúÏÇ¨ Í∏∞Î∞ò ÏπòÏú† ÏõåÌÅ¨ÏãúÌä∏</h1>
            <p>Í∞êÏ†ï ¬∑ Í¥ÄÍ≥Ñ ¬∑ ÏöïÎßù ¬∑ ÏÑ±Ïû• Í∏∞Î∞ò ÌÜµÌï© Íµ¨Ï°∞</p>
        </div>

        <div class="content">
            <!-- 1. Ï£ºÏù∏Í≥µ Ï†ïÎ≥¥ -->
            <div class="section">
                <h2>1. Ï£ºÏù∏Í≥µ Ï†ïÎ≥¥</h2>
                <table>
                    <tr>
                        <th>Ìï≠Î™©</th>
                        <th>ÎÇ¥Ïö©</th>
                    </tr>
                    <tr>
                        <td><strong>Ïù¥Î¶Ñ</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" value="">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>ÏÑ±Î≥Ñ</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="ÏÑ±Î≥ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" value="">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>ÎÇòÏù¥</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="ÎÇòÏù¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" value="">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>ÏßÅÏóÖ</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="ÏßÅÏóÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" value="">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>ÌèâÏÜå ÎßêÌà¨¬∑ÌñâÎèô¬∑ÏäµÍ¥Ä</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="ÌèâÏÜå ÎßêÌà¨, ÌñâÎèô, ÏäµÍ¥ÄÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" value="">
                        </td>
                    </tr>
                </table>
            </div>

                         <!-- 2. Ï£ºÎ≥Ä Ïù∏Î¨º Í¥ÄÍ≥Ñ Ï†ïÎ¶¨ -->
             <div class="section">
                 <h2>2. Ï£ºÎ≥Ä Ïù∏Î¨º Í¥ÄÍ≥Ñ Ï†ïÎ¶¨</h2>
                 <p class="highlight"><em>Ï∂úÏ≤ò: Ïã†Ï§ÄÏÑ≠ & Ïù¥ÏòÅÎ∂Ñ, 1999 / MSPSS Í∏∞Î∞ò</em></p>
                 
                 <button class="add-character-btn" onclick="addCharacter()">‚ûï Ï£ºÎ≥Ä Ïù∏Î¨º Ï∂îÍ∞Ä</button>
                 
                 <div id="characters-container">
                     <table id="characters-table">
                         <thead>
                             <tr>
                                 <th>Ìï≠Î™©</th>
                                 <th>Ï£ºÎ≥Ä Ïù∏Î¨º 1 <button class="remove-character-btn" onclick="removeCharacter(1)" title="ÏÇ≠Ï†ú">√ó</button></th>
                             </tr>
                         </thead>
                         <tbody>
                             <tr>
                                 <td><strong>Ïù¥Î¶Ñ</strong></td>
                                 <td class="editable-cell">
                                     <input type="text" placeholder="Ïù∏Î¨ºÏùò Ïù¥Î¶Ñ" value="">
                                 </td>
                             </tr>
                             <tr>
                                 <td><strong>Í¥ÄÍ≥Ñ Î≤îÏ£º</strong></td>
                                 <td class="editable-cell">
                                     <input type="text" placeholder="Í∞ÄÏ°±/ÏπúÍµ¨/Í∏∞ÌÉÄ" value="">
                                 </td>
                             </tr>
                             <tr>
                                 <td><strong>ÏßÄÏßÄ Ïó¨Î∂Ä</strong></td>
                                 <td>
                                     <div class="likert-scale">
                                         <div class="likert-item">
                                             <input type="radio" name="support1" id="support1_very_hostile" value="Îß§Ïö∞ Ï†ÅÎåÄ">
                                             <label for="support1_very_hostile">Îß§Ïö∞ Ï†ÅÎåÄ</label>
                                         </div>
                                         <div class="likert-item">
                                             <input type="radio" name="support1" id="support1_hostile" value="Ï†ÅÎåÄ">
                                             <label for="support1_hostile">Ï†ÅÎåÄ</label>
                                         </div>
                                         <div class="likert-item">
                                             <input type="radio" name="support1" id="support1_neutral" value="Î≥¥ÌÜµ">
                                             <label for="support1_neutral">Î≥¥ÌÜµ</label>
                                         </div>
                                         <div class="likert-item">
                                             <input type="radio" name="support1" id="support1_support" value="ÏßÄÏßÄ">
                                             <label for="support1_support">ÏßÄÏßÄ</label>
                                         </div>
                                         <div class="likert-item">
                                             <input type="radio" name="support1" id="support1_very_support" value="Îß§Ïö∞ ÏßÄÏßÄ">
                                             <label for="support1_very_support">Îß§Ïö∞ ÏßÄÏßÄ</label>
                                         </div>
                                     </div>
                                 </td>
                             </tr>
                             <tr>
                                 <td><strong>Ïù∏Î¨º ÌäπÏßï</strong></td>
                                 <td class="editable-cell">
                                     <input type="text" placeholder="Ïù∏Î¨ºÏùò ÌäπÏßï" value="">
                                 </td>
                             </tr>
                             <tr>
                                 <td><strong>Ï£ºÏù∏Í≥µÏóêÍ≤å Ï§Ä ÏòÅÌñ•</strong></td>
                                 <td class="editable-cell">
                                     <input type="text" placeholder="ÎØ∏Ïπú ÏòÅÌñ•" value="">
                                 </td>
                             </tr>
                         </tbody>
                     </table>
                 </div>
             </div>

            <!-- 3. Í≥ºÍ±∞Ïùò ÏÇ¨Í±¥ -->
            <div class="section">
                <h2>3. Í≥ºÍ±∞Ïùò ÏÇ¨Í±¥</h2>
                <p class="highlight"><em>Ï∂úÏ≤ò: ÏïàÌòÑÏùò Ïô∏, 2013 / K-ERRI Í∏∞Î∞ò</em></p>
                
                                 <h3>Í∏∞Ïñµ Í∏∞Î≥∏ ÌîÑÎ†àÏûÑ</h3>
                 <div class="quote-box">
                     <textarea placeholder="ÏòàÏãú: 'Ï≤≠ÏÜåÎÖÑ ÏãúÏ†à, ÎÇ®ÏõêÏóêÏÑú Ï∂òÌñ•Ïù¥ÏôÄ ÏûàÏóàÍ≥†, ÎÇòÎäî Í∏∞ÏÅ®Í≥º ÏÑ§Î†òÏùÑ ÎäêÍºàÎã§.'&#10;&#10;ÏúÑ ÌòïÏãùÏùÑ Ï∞∏Í≥†ÌïòÏó¨ Í≥ºÍ±∞Ïùò Ï§ëÏöîÌïú ÏÇ¨Í±¥ÏùÑ ÏûêÏÑ∏Ìûà Í∏∞Ïà†Ìï¥Î≥¥ÏÑ∏Ïöî."></textarea>
                 </div>

                 <h3>ÏÉùÍ∞ÅÌïòÍ≥† Ïã∂ÏßÄ ÏïäÏïÑÎèÑ Ï†ÄÏ†àÎ°ú Îñ†Ïò§Î•¥Îäî Í∏∞Ïñµ</h3>
                 <div class="checkbox-group">
                     <div class="checkbox-item">
                         <input type="radio" name="intrusive" id="intrusive_yes" value="ÏûàÏùå" onchange="toggleIntrusiveInput()">
                         <label for="intrusive_yes">ÏûàÏùå</label>
                     </div>
                     <div class="checkbox-item">
                         <input type="radio" name="intrusive" id="intrusive_no" value="ÏóÜÏùå" onchange="toggleIntrusiveInput()">
                         <label for="intrusive_no">ÏóÜÏùå</label>
                     </div>
                 </div>

                 <div id="intrusive_yes_input" style="display: none;">
                     <h3>üåÄ ÏÉùÍ∞ÅÌïòÍ≥† Ïã∂ÏßÄ ÏïäÏïÑÎèÑ Ï†ÄÏ†àÎ°ú Îñ†Ïò§Î•¥Îäî Í∏∞Ïñµ</h3>
                     <div class="quote-box">
                         <textarea placeholder="Í∑∏ Í∏∞ÏñµÏùÄ ÎÇòÎ•º ___ÌïòÍ≤å ÌïúÎã§ / Í∑∏ Í∏∞Ïñµ ÎïåÎ¨∏Ïóê ÎÇòÎäî ___ÌïòÍ≤å ÎêúÎã§.&#10;&#10;ÏúÑ ÌòïÏãùÏùÑ Ï∞∏Í≥†ÌïòÏó¨ Í∑∏ Í∏∞ÏñµÏù¥ ÎÇòÏóêÍ≤å ÎØ∏ÏπòÎäî ÏòÅÌñ•ÏùÑ ÏûëÏÑ±Ìï¥Î≥¥ÏÑ∏Ïöî."></textarea>
                     </div>
                     
                     <h3>‚òÄÔ∏è Ï£ºÏù∏Í≥µÏù¥ Îä•ÎèôÏ†ÅÏúºÎ°ú Îñ†Ïò¨Î¶¨Îäî Í∏∞Ïñµ</h3>
                     <div class="quote-box">
                         <textarea placeholder="Í∑∏ Í≤ΩÌóòÏùÑ Îñ†Ïò¨Î¶¨Î©∞ ÎÇòÎäî (Í∞êÏ†ï)ÏùÑ Îã§Ïãú ÎßàÏ£ºÌïúÎã§.&#10;Í∑∏ Í≤∞Í≥º ÎÇòÎäî ___ÏùÑ Î∞∞Ïõ†Îã§ / Íπ®Îã¨ÏïòÎã§ / Îã§Î•¥Í≤å ÎäêÎÅºÍ≤å ÎêòÏóàÎã§.&#10;&#10;ÏúÑ ÌòïÏãùÏùÑ Ï∞∏Í≥†ÌïòÏó¨ Í∑∏ Í≤ΩÌóòÏùò ÏùòÎØ∏Î•º ÏûëÏÑ±Ìï¥Î≥¥ÏÑ∏Ïöî."></textarea>
                     </div>
                 </div>

                 <div id="intrusive_no_input" style="display: none;">
                     <h3>‚òÄÔ∏è Ï£ºÏù∏Í≥µÏù¥ Îä•ÎèôÏ†ÅÏúºÎ°ú Îñ†Ïò¨Î¶¨Îäî Í∏∞Ïñµ</h3>
                     <div class="quote-box">
                         <textarea placeholder="Í∑∏ Í≤ΩÌóòÏùÑ Îñ†Ïò¨Î¶¨Î©∞ ÎÇòÎäî (Í∞êÏ†ï)ÏùÑ Îã§Ïãú ÎßàÏ£ºÌïúÎã§.&#10;Í∑∏ Í≤∞Í≥º ÎÇòÎäî ___ÏùÑ Î∞∞Ïõ†Îã§ / Íπ®Îã¨ÏïòÎã§ / Îã§Î•¥Í≤å ÎäêÎÅºÍ≤å ÎêòÏóàÎã§.&#10;&#10;ÏúÑ ÌòïÏãùÏùÑ Ï∞∏Í≥†ÌïòÏó¨ Í∑∏ Í≤ΩÌóòÏùò ÏùòÎØ∏Î•º ÏûëÏÑ±Ìï¥Î≥¥ÏÑ∏Ïöî."></textarea>
                     </div>
                 </div>

                                   <h3>Í≤∞Í≥ºÏ†ÅÏúºÎ°ú Í∑∏ Í∏∞ÏñµÏùÄ ÎÇ¥ ÏÇ∂ÏóêÏÑú:</h3>
                                                                       <div class="likert-scale">
                       <div class="likert-item">
                           <input type="radio" name="memory_impact" id="impact_1" value="Ï†ÑÌòÄ ÏòÅÌñ•ÏùÑ Ï£ºÏßÄ ÏïäÎäîÎã§">
                           <label for="impact_1">Ï†ÑÌòÄ ÏòÅÌñ•ÏùÑ Ï£ºÏßÄ ÏïäÎäîÎã§</label>
                       </div>
                       <div class="likert-item">
                           <input type="radio" name="memory_impact" id="impact_2" value="Í±∞Ïùò Îñ†Ïò§Î•¥ÏßÄ ÏïäÍ≥†, ÏÇ∂Ïóê ÏòÅÌñ•ÏùÑ Ï£ºÏßÄ ÏïäÎäîÎã§">
                           <label for="impact_2">Í±∞Ïùò Îñ†Ïò§Î•¥ÏßÄ ÏïäÍ≥†, ÏÇ∂Ïóê ÏòÅÌñ•ÏùÑ Ï£ºÏßÄ ÏïäÎäîÎã§</label>
                       </div>
                       <div class="likert-item">
                           <input type="radio" name="memory_impact" id="impact_3" value="Í∞ÄÎÅî Îñ†Ïò§Î•¥ÏßÄÎßå, ÏÇ∂Ïóê ÌÅ∞ ÏòÅÌñ•ÏùÑ Ï£ºÏßÄÎäî ÏïäÎäîÎã§">
                           <label for="impact_3">Í∞ÄÎÅî Îñ†Ïò§Î•¥ÏßÄÎßå, ÏÇ∂Ïóê ÌÅ∞ ÏòÅÌñ•ÏùÑ Ï£ºÏßÄÎäî ÏïäÎäîÎã§</label>
                       </div>
                       <div class="likert-item">
                           <input type="radio" name="memory_impact" id="impact_4" value="ÏûêÏ£º Îñ†Ïò§Î•¥Î©∞, ÎÇ¥ ÏÉùÍ∞ÅÏù¥ÎÇò Î∞©Ìñ•Ïóê ÏòÅÌñ•ÏùÑ Ï£ºÍ≥§ ÌïúÎã§">
                           <label for="impact_4">ÏûêÏ£º Îñ†Ïò§Î•¥Î©∞, ÎÇ¥ ÏÉùÍ∞ÅÏù¥ÎÇò Î∞©Ìñ•Ïóê ÏòÅÌñ•ÏùÑ Ï£ºÍ≥§ ÌïúÎã§</label>
                       </div>
                       <div class="likert-item">
                           <input type="radio" name="memory_impact" id="impact_5" value="ÎÇ¥Í∞Ä ÏÑ±Ïû•ÌïòÍ≥† Îã®Îã®Ìï¥ÏßÄÎäî Îç∞ ÍπäÏùÄ ÏòÅÌñ•ÏùÑ Ï£ºÏóàÎã§">
                           <label for="impact_5">ÎÇ¥Í∞Ä ÏÑ±Ïû•ÌïòÍ≥† Îã®Îã®Ìï¥ÏßÄÎäî Îç∞ ÍπäÏùÄ ÏòÅÌñ•ÏùÑ Ï£ºÏóàÎã§</label>
                       </div>
                   </div>
            </div>

            <!-- 4. ÏöïÎßù Î∞è Íøà -->
            <div class="section">
                                 <h2>4. ÏöïÎßù Î∞è Íøà</h2>
                 <p class="highlight"><em>Ï∂úÏ≤ò: Snyder et al., 1991; Gabrielsen et al., 2012</em></p>
                
                <table>
                    <tr>
                        <th>Ìï≠Î™©</th>
                        <th>ÏûëÏÑ±</th>
                    </tr>
                    <tr>
                        <td><strong>Î™©Ìëú ÎÇ¥Ïö©</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="ÎÇòÎäî OOOÏùÑ/Î•º Ïù¥Î£®Í≥† Ïã∂Îã§" value="">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Ï§ëÏöîÎèÑ</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="Ïù¥ Î™©ÌëúÎäî ÎÇòÏóêÍ≤å Îß§Ïö∞ Ï§ëÏöîÌïòÎã§. ÏôúÎÉêÌïòÎ©¥ OOO ÎïåÎ¨∏Ïù¥Îã§" value="">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Ïã§ÌòÑ Í∞ÄÎä•ÏÑ±</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="ÎÇòÎäî Ïù¥Í≤ÉÏù¥ Í∞ÄÎä•ÌïòÎã§Í≥† ÏÉùÍ∞ÅÌïúÎã§. ÏôúÎÉêÌïòÎ©¥ A, B, C Î∞©Î≤ïÏùÑ ÏÉùÍ∞ÅÌï¥Î¥§Í∏∞ ÎïåÎ¨∏Ïù¥Îã§" value="">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Î∞©Ìï¥ ÏöîÏÜå</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="ÌïòÏßÄÎßå ÎÇòÎ•º ÎßâÎäî Í±¥ ÎÇ¥ Í∞êÏ†ï/Í¥ÄÍ≥Ñ/Ï†úÎèÑ/ÏÉÅÌô©Ïù¥Îã§" value="">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>ÎèôÍ∏∞ ÏûêÏõê</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="Í∑∏ÎüºÏóêÎèÑ Î∂àÍµ¨ÌïòÍ≥†, ÎÇòÎäî ÎÇ¥ Í∞ïÏ†ê/Ïã†ÎÖê/Í≤ΩÌóò ÎçïÎ∂ÑÏóê Í≥ÑÏÜç ÎÇòÏïÑÍ∞ÄÍ≥† ÏûàÎã§" value="">
                        </td>
                    </tr>
                </table>
            </div>

                         <!-- 5. Ï£ºÏöî Í∞àÎì± -->
             <div class="section">
                 <h2>5. Ï£ºÏöî Í∞àÎì±</h2>
                 <p class="highlight"><em>Í∞êÏ†ï: DES ÎòêÎäî PANAS ÏÇ¨Ïö© Í∞ÄÎä• / Í¥ÄÍ≥Ñ Ïú†Ìòï: ‚úî ÏßÄÏßÄ / ‚úñ Ï†ÅÎåÄ / ¬± ÌòºÌï©</em></p>
                 
                 <div class="circle-container">
                     <div class="circle outer-circle"></div>
                     <div class="circle middle-circle"></div>
                     <div class="circle inner-circle"></div>
                     <div class="label label-inner">ÎÇ¥Ï†Å Í∞àÎì±</div>
                     <div class="label label-middle">Í∞úÏù∏Ï†Å Í∞àÎì±</div>
                     <div class="label label-outer">Ï¥àÍ∞úÏù∏Ï†Å Í∞àÎì±</div>
                 </div>

                 <!-- ÎÇ¥Ï†Å Í∞àÎì± -->
                 <div class="conflict-section">
                     <h3>1. ÎÇ¥Ï†Å Í∞àÎì±</h3>
                     <input type="text" placeholder="ÎåÄÏÉÅ ÎòêÎäî ÏÇ¨Í±¥ (Ïòà: ÎÇò ÏûêÏã†, Î¨¥Í∏∞Î†• Îì±)">
                     <input type="text" placeholder="Ï£ºÏù∏Í≥µÏù¥ ÎäêÎÇÄ Í∞êÏ†ï (Ïòà: ÏàòÏπòÏã¨, ÌòºÎûÄ)">
                     <input type="text" placeholder="Í∞êÏ†ïÏùÑ Ï¥âÎ∞úÌïú ÏÉÅÌô© (Ïòà: Ïã§Ìå®, ÌõÑÌöå)">
                     <div class="radio-group">
                         <label><input type="radio" name="inner_relation" value="Îß§Ïö∞ Ï†ÅÎåÄ"> Îß§Ïö∞ Ï†ÅÎåÄ</label>
                         <label><input type="radio" name="inner_relation" value="Ï†ÅÎåÄ"> Ï†ÅÎåÄ</label>
                         <label><input type="radio" name="inner_relation" value="Î≥¥ÌÜµ"> Î≥¥ÌÜµ</label>
                         <label><input type="radio" name="inner_relation" value="ÏßÄÏßÄ"> ÏßÄÏßÄ</label>
                         <label><input type="radio" name="inner_relation" value="Îß§Ïö∞ ÏßÄÏßÄ"> Îß§Ïö∞ ÏßÄÏßÄ</label>
                     </div>
                 </div>

                 <!-- Í∞úÏù∏Ï†Å Í∞àÎì± -->
                 <div class="conflict-section">
                     <h3>2. Í∞úÏù∏Ï†Å Í∞àÎì±</h3>
                     <table id="personal-conflict-table">
                         <thead>
                             <tr>
                                 <th>Íµ¨Î∂Ñ</th>
                                 <th>ÎåÄÏÉÅ/ÏÇ¨Í±¥</th>
                                 <th>Í∞êÏ†ï</th>
                                 <th>ÏÉÅÌô©</th>
                                 <th>Í¥ÄÍ≥Ñ Ïú†Ìòï</th>
                                 <th>ÏÇ≠Ï†ú</th>
                             </tr>
                         </thead>
                         <tbody>
                             <tr>
                                 <td>Í∞úÏù∏Ï†Å1</td>
                                 <td class="editable-cell"><textarea placeholder="ÎàÑÎÇò"></textarea></td>
                                 <td class="editable-cell"><textarea placeholder="Î∂ÑÎÖ∏"></textarea></td>
                                 <td class="editable-cell"><textarea placeholder="Î¨¥ÏãúÎãπÌï®"></textarea></td>
                                 <td>
                                     <select name="interpersonal_relation_1">
                                         <option value="Îß§Ïö∞ Ï†ÅÎåÄ">Îß§Ïö∞ Ï†ÅÎåÄ</option>
                                         <option value="Ï†ÅÎåÄ" selected>Ï†ÅÎåÄ</option>
                                         <option value="Î≥¥ÌÜµ">Î≥¥ÌÜµ</option>
                                         <option value="ÏßÄÏßÄ">ÏßÄÏßÄ</option>
                                         <option value="Îß§Ïö∞ ÏßÄÏßÄ">Îß§Ïö∞ ÏßÄÏßÄ</option>
                                     </select>
                                 </td>
                                 <td><button class="remove-character-btn" onclick="removeRow(this)">√ó</button></td>
                             </tr>
                             <tr>
                                 <td>Í∞úÏù∏Ï†Å2</td>
                                 <td class="editable-cell"><textarea placeholder="ÏπúÍµ¨"></textarea></td>
                                 <td class="editable-cell"><textarea placeholder="Í±∞Î¶¨Í∞ê"></textarea></td>
                                 <td class="editable-cell"><textarea placeholder="Í±∞Ï†àÎãπÌï®"></textarea></td>
                                 <td>
                                     <select name="interpersonal_relation_2">
                                         <option value="Îß§Ïö∞ Ï†ÅÎåÄ">Îß§Ïö∞ Ï†ÅÎåÄ</option>
                                         <option value="Ï†ÅÎåÄ">Ï†ÅÎåÄ</option>
                                         <option value="Î≥¥ÌÜµ" selected>Î≥¥ÌÜµ</option>
                                         <option value="ÏßÄÏßÄ">ÏßÄÏßÄ</option>
                                         <option value="Îß§Ïö∞ ÏßÄÏßÄ">Îß§Ïö∞ ÏßÄÏßÄ</option>
                                     </select>
                                 </td>
                                 <td><button class="remove-character-btn" onclick="removeRow(this)">√ó</button></td>
                             </tr>
                         </tbody>
                     </table>
                     <button class="add-character-btn" onclick="addPersonalConflictRow()">‚ûï Ìñâ Ï∂îÍ∞Ä</button>
                 </div>
 
                 <!-- Ï¥àÍ∞úÏù∏Ï†Å Í∞àÎì± -->
                 <div class="conflict-section">
                     <h3>3. Ï¥àÍ∞úÏù∏Ï†Å Í∞àÎì±</h3>
                     <table id="societal-conflict-table">
                         <thead>
                             <tr>
                                 <th>Íµ¨Î∂Ñ</th>
                                 <th>ÎåÄÏÉÅ/ÏÇ¨Í±¥</th>
                                 <th>Í∞êÏ†ï</th>
                                 <th>ÏÉÅÌô©</th>
                                 <th>Í¥ÄÍ≥Ñ Ïú†Ìòï</th>
                                 <th>ÏÇ≠Ï†ú</th>
                             </tr>
                         </thead>
                         <tbody>
                             <tr>
                                 <td>Ï¥àÍ∞úÏù∏Ï†Å1</td>
                                 <td class="editable-cell"><textarea placeholder="ÌïôÎ≤å Íµ¨Ï°∞"></textarea></td>
                                 <td class="editable-cell"><textarea placeholder="Ï≤¥ÎÖê"></textarea></td>
                                 <td class="editable-cell"><textarea placeholder="Ï∑®ÏóÖ ÌÉàÎùΩ"></textarea></td>
                                 <td>
                                     <select name="societal_relation_1">
                                         <option value="Îß§Ïö∞ Ï†ÅÎåÄ" selected>Îß§Ïö∞ Ï†ÅÎåÄ</option>
                                         <option value="Ï†ÅÎåÄ">Ï†ÅÎåÄ</option>
                                         <option value="Î≥¥ÌÜµ">Î≥¥ÌÜµ</option>
                                         <option value="ÏßÄÏßÄ">ÏßÄÏßÄ</option>
                                         <option value="Îß§Ïö∞ ÏßÄÏßÄ">Îß§Ïö∞ ÏßÄÏßÄ</option>
                                     </select>
                                 </td>
                                 <td><button class="remove-character-btn" onclick="removeRow(this)">√ó</button></td>
                             </tr>
                             <tr>
                                 <td>Ï¥àÍ∞úÏù∏Ï†Å2</td>
                                 <td class="editable-cell"><textarea placeholder="Î≥ëÏõê ÏãúÏä§ÌÖú"></textarea></td>
                                 <td class="editable-cell"><textarea placeholder="Î¨¥Î†•Í∞ê"></textarea></td>
                                 <td class="editable-cell"><textarea placeholder="ÏÉÅÎã¥ Ïó∞Í≤∞ Ïïà Îê®"></textarea></td>
                                 <td>
                                     <select name="societal_relation_2">
                                         <option value="Îß§Ïö∞ Ï†ÅÎåÄ">Îß§Ïö∞ Ï†ÅÎåÄ</option>
                                         <option value="Ï†ÅÎåÄ" selected>Ï†ÅÎåÄ</option>
                                         <option value="Î≥¥ÌÜµ">Î≥¥ÌÜµ</option>
                                         <option value="ÏßÄÏßÄ">ÏßÄÏßÄ</option>
                                         <option value="Îß§Ïö∞ ÏßÄÏßÄ">Îß§Ïö∞ ÏßÄÏßÄ</option>
                                     </select>
                                 </td>
                                 <td><button class="remove-character-btn" onclick="removeRow(this)">√ó</button></td>
                             </tr>
                         </tbody>
                     </table>
                     <button class="add-character-btn" onclick="addSocietalConflictRow()">‚ûï Ìñâ Ï∂îÍ∞Ä</button>
                 </div>
             </div>

            <!-- 6. Í∞ïÏ†êÍ≥º ÏûêÏßà -->
            <div class="section">
                <h2>6. Í∞ïÏ†êÍ≥º ÏûêÏßà</h2>
                <h3>Í≥µÏãù ÌîÑÎ†àÏûÑ</h3>
                <div class="quote-box">
                    <p><em>"ÎÇòÎäî (Ïû•Ï†ê)ÏùÑ Í∞ñÍ≥† ÏûàÎã§. ÎïåÎ°† (Îã®Ï†ê)Ïù¥ÏßÄÎßå, Í≤∞Íµ≠ (Ïû•Ï†êÏùò Îã§Î•∏ ÌëúÌòÑ)ÏúºÎ°ú Í∑πÎ≥µÌïúÎã§."</em></p>
                </div>
                
                <h3>ÎÇòÏùò Í∞ïÏ†êÍ≥º ÏûêÏßà</h3>
                <div class="quote-box">
                    <textarea placeholder="ÏúÑ ÌîÑÎ†àÏûÑÏùÑ Ï∞∏Í≥†ÌïòÏó¨ ÎÇòÏùò Í∞ïÏ†êÍ≥º ÏûêÏßàÏùÑ ÏûêÏú†Î°≠Í≤å ÏûëÏÑ±Ìï¥Î≥¥ÏÑ∏Ïöî.&#10;&#10;ÏòàÏãú: 'ÎÇòÎäî Í∞êÏ†ïÏóê ÎØºÍ∞êÌïú ÏÇ¨ÎûåÏù¥Îã§. ÎïåÎ°úÎäî Í≥ºÎØºÌïòÍ≤å Î∞òÏùëÌïòÏßÄÎßå, Í≤∞Íµ≠ ÌÉÄÏù∏ÏùÑ Îçî Ïûò Ïù¥Ìï¥ÌïòÎäî ÏÇ¨ÎûåÏúºÎ°ú ÏÑ±Ïû•ÌïòÍ≥† ÏûàÎã§.'"></textarea>
                </div>
            </div>

            <!-- 7. ÏÑ±Ïû•Ïùò ÏàúÍ∞Ñ -->
            <div class="section">
                <h2>7. ÏÑ±Ïû•Ïùò ÏàúÍ∞Ñ</h2>
                <table>
                    <tr>
                        <th>Ìï≠Î™©</th>
                        <th>ÏûëÏÑ±</th>
                    </tr>
                    <tr>
                        <td><strong>Í≥ÑÍ∏∞</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="Í∑∏ ÏÇ¨Í±¥/Ïù∏Î¨º/Í∞êÏ†ïÏùÑ Í≥ÑÍ∏∞Î°ú..." value="">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Ï†ÑÌôò</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="ÎÇòÎäî Í∑∏ÎïåÎ∂ÄÌÑ∞ OOOÏùÑ Îã§Î•¥Í≤å Î≥¥Í≤å ÎêòÏóàÎã§" value="">
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Í≤∞Í≥º</strong></td>
                        <td class="editable-cell">
                            <input type="text" placeholder="Í∑∏ Í≤∞Í≥º ÎÇòÎäî OOOÌïú ÏÇ∂ÏùÑ ÏÇ¥Í≤å ÎêòÏóàÎã§" value="">
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <script>
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º
        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('.section');
            sections.forEach((section, index) => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    section.style.transition = 'all 0.6s ease';
                    section.style.opacity = '1';
                    section.style.transform = 'translateY(0)';
                }, index * 200);
            });
        });

        // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Í∏∞Îä•
        function saveData() {
            const formData = {};
            
            // Î™®Îì† ÏûÖÎ†• ÌïÑÎìú ÏàòÏßë
            document.querySelectorAll('input[type="text"], textarea').forEach(input => {
                formData[input.placeholder || input.name] = input.value;
            });
            
            // ÎùºÎîîÏò§ Î≤ÑÌäº ÏÉÅÌÉú ÏàòÏßë
            document.querySelectorAll('input[type="radio"]:checked').forEach(radio => {
                formData[radio.name] = radio.value;
            });
            
            // Ï≤¥ÌÅ¨Î∞ïÏä§ ÏÉÅÌÉú ÏàòÏßë
            document.querySelectorAll('input[type="checkbox"]:checked').forEach(checkbox => {
                if (!formData[checkbox.name]) {
                    formData[checkbox.name] = [];
                }
                formData[checkbox.name].push(checkbox.value);
            });
            
            // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû•
            localStorage.setItem('narrativeWorksheet', JSON.stringify(formData));
            alert('ÏõåÌÅ¨ÏãúÌä∏Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
        }

                 // Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞ Í∏∞Îä•
         function loadData() {
             const savedData = localStorage.getItem('narrativeWorksheet');
             if (savedData) {
                 const formData = JSON.parse(savedData);
                 
                 // ÏûÖÎ†• ÌïÑÎìú Î≥µÏõê
                 document.querySelectorAll('input[type="text"], textarea').forEach(input => {
                     const key = input.placeholder || input.name;
                     if (formData[key]) {
                         input.value = formData[key];
                     }
                 });
                 
                 // ÎùºÎîîÏò§ Î≤ÑÌäº ÏÉÅÌÉú Î≥µÏõê
                 document.querySelectorAll('input[type="radio"]').forEach(radio => {
                     if (formData[radio.name] === radio.value) {
                         radio.checked = true;
                     }
                 });
                 
                 // Ï≤¥ÌÅ¨Î∞ïÏä§ ÏÉÅÌÉú Î≥µÏõê
                 document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                     if (formData[checkbox.name] && formData[checkbox.name].includes(checkbox.value)) {
                         checkbox.checked = true;
                     }
                 });
                 
                 alert('Ï†ÄÏû•Îêú Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨ÏôîÏäµÎãàÎã§!');
             } else {
                 alert('Ï†ÄÏû•Îêú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
             }
         }

        // ÌÖçÏä§Ìä∏ÏóêÏñ¥Î¶¨Ïñ¥ ÏûêÎèô Î¶¨ÏÇ¨Ïù¥Ï¶à
        document.addEventListener('input', function(e) {
            if (e.target && e.target.tagName === 'TEXTAREA') {
                e.target.style.height = 'auto';
                e.target.style.height = (e.target.scrollHeight) + 'px';
            }
        });

        // Ìñâ Ï∂îÍ∞ÄÏö© Ïπ¥Ïö¥ÌÑ∞
        let personalConflictCount = 2;
        let societalConflictCount = 2;

        function addPersonalConflictRow() {
            personalConflictCount++;
            const tbody = document.querySelector('#personal-conflict-table tbody');
            if (!tbody) return;
            const rowNumber = personalConflictCount;
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>Í∞úÏù∏Ï†Å${rowNumber}</td>
                <td class="editable-cell"><textarea placeholder="ÎåÄÏÉÅ/ÏÇ¨Í±¥"></textarea></td>
                <td class="editable-cell"><textarea placeholder="Í∞êÏ†ï"></textarea></td>
                <td class="editable-cell"><textarea placeholder="ÏÉÅÌô©"></textarea></td>
                <td>
                    <select name="interpersonal_relation_${rowNumber}">
                        <option value="Îß§Ïö∞ Ï†ÅÎåÄ">Îß§Ïö∞ Ï†ÅÎåÄ</option>
                        <option value="Ï†ÅÎåÄ">Ï†ÅÎåÄ</option>
                        <option value="Î≥¥ÌÜµ" selected>Î≥¥ÌÜµ</option>
                        <option value="ÏßÄÏßÄ">ÏßÄÏßÄ</option>
                        <option value="Îß§Ïö∞ ÏßÄÏßÄ">Îß§Ïö∞ ÏßÄÏßÄ</option>
                    </select>
                </td>
                <td><button class="remove-character-btn" onclick="removeRow(this)">√ó</button></td>
            `;
            tbody.appendChild(tr);
        }

        function removePersonalConflictRow(rowNumber) {
            const table = document.getElementById('personal-conflict-table');
            const tbody = table.querySelector('tbody');
            const rows = tbody.querySelectorAll('tr');
            const rowToRemove = rows.find(row => row.querySelector('td:first-child').textContent.includes(`Í∞úÏù∏Ï†Å${rowNumber}`));

            if (rows.length <= 2) { // ÏµúÏÜå 1Î™ÖÏùÄ Ïú†ÏßÄ
                alert('ÏµúÏÜå 1Î™ÖÏùò Ï£ºÎ≥Ä Ïù∏Î¨ºÏùÄ Ïú†ÏßÄÌï¥Ïïº Ìï©ÎãàÎã§.');
                return;
            }

            rowToRemove.remove();

            // Î≤àÌò∏ Ïû¨Ï†ïÎ†¨
            const remainingRows = tbody.querySelectorAll('tr');
            remainingRows.forEach((row, index) => {
                const firstCell = row.querySelector('td:first-child');
                if (firstCell) {
                    const button = row.querySelector('.remove-character-btn');
                    if (button) {
                        button.onclick = () => removePersonalConflictRow(index + 1);
                    }
                }
            });
        }

        function addSocietalConflictRow() {
            societalConflictCount++;
            const tbody = document.querySelector('#societal-conflict-table tbody');
            if (!tbody) return;
            const rowNumber = societalConflictCount;
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>Ï¥àÍ∞úÏù∏Ï†Å${rowNumber}</td>
                <td class="editable-cell"><textarea placeholder="ÎåÄÏÉÅ/ÏÇ¨Í±¥"></textarea></td>
                <td class="editable-cell"><textarea placeholder="Í∞êÏ†ï"></textarea></td>
                <td class="editable-cell"><textarea placeholder="ÏÉÅÌô©"></textarea></td>
                <td>
                    <select name="societal_relation_${rowNumber}">
                        <option value="Îß§Ïö∞ Ï†ÅÎåÄ">Îß§Ïö∞ Ï†ÅÎåÄ</option>
                        <option value="Ï†ÅÎåÄ">Ï†ÅÎåÄ</option>
                        <option value="Î≥¥ÌÜµ" selected>Î≥¥ÌÜµ</option>
                        <option value="ÏßÄÏßÄ">ÏßÄÏßÄ</option>
                        <option value="Îß§Ïö∞ ÏßÄÏßÄ">Îß§Ïö∞ ÏßÄÏßÄ</option>
                    </select>
                </td>
                <td><button class="remove-character-btn" onclick="removeRow(this)">√ó</button></td>
            `;
            tbody.appendChild(tr);
        }

        function removeRow(button) {
            const tr = button.closest('tr');
            if (!tr) return;
            const table = tr.closest('table');
            const tbody = table ? table.querySelector('tbody') : null;
            if (!tbody) return;
            // Ensure at least 2 rows remain
            if (tbody.rows.length <= 2) {
                alert('ÏµúÏÜå 2Í∞úÏùò Ìï≠Î™©ÏùÄ Ïú†ÏßÄÌï¥Ïïº Ìï©ÎãàÎã§.');
                return;
            }
            tbody.removeChild(tr);
        }

                   // Ï£ºÎ≥Ä Ïù∏Î¨º Ï∂îÍ∞Ä Í∏∞Îä•
          let characterCount = 1;
          
          function addCharacter() {
              characterCount++;
              const table = document.getElementById('characters-table');
              const tbody = table.querySelector('tbody');
              const thead = table.querySelector('thead tr');
              
              // Ìó§ÎçîÏóê ÏÉà Ïª¨Îüº Ï∂îÍ∞Ä
              const newHeaderCell = document.createElement('th');
              newHeaderCell.innerHTML = `Ï£ºÎ≥Ä Ïù∏Î¨º ${characterCount} <button class="remove-character-btn" onclick="removeCharacter(${characterCount})" title="ÏÇ≠Ï†ú">√ó</button>`;
              thead.appendChild(newHeaderCell);
              
              // Í∞Å ÌñâÏóê ÏÉà ÏÖÄ Ï∂îÍ∞Ä
              const rows = tbody.querySelectorAll('tr');
              rows.forEach((row, index) => {
                  const newCell = document.createElement('td');
                  newCell.className = 'editable-cell';
                  
                  if (index === 0) { // Ïù¥Î¶Ñ
                      newCell.innerHTML = '<input type="text" placeholder="Ïù∏Î¨ºÏùò Ïù¥Î¶Ñ" value="">';
                  } else if (index === 1) { // Í¥ÄÍ≥Ñ Î≤îÏ£º
                      newCell.innerHTML = '<input type="text" placeholder="Í∞ÄÏ°±/ÏπúÍµ¨/Í∏∞ÌÉÄ" value="">';
                  } else if (index === 2) { // ÏßÄÏßÄ Ïó¨Î∂Ä
                      newCell.innerHTML = `
                          <div class="likert-scale">
                              <div class="likert-item">
                                  <input type="radio" name="support${characterCount}" id="support${characterCount}_very_hostile" value="Îß§Ïö∞ Ï†ÅÎåÄ">
                                  <label for="support${characterCount}_very_hostile">Îß§Ïö∞ Ï†ÅÎåÄ</label>
                              </div>
                              <div class="likert-item">
                                  <input type="radio" name="support${characterCount}" id="support${characterCount}_hostile" value="Ï†ÅÎåÄ">
                                  <label for="support${characterCount}_hostile">Ï†ÅÎåÄ</label>
                              </div>
                              <div class="likert-item">
                                  <input type="radio" name="support${characterCount}" id="support${characterCount}_neutral" value="Î≥¥ÌÜµ">
                                  <label for="support${characterCount}_neutral">Î≥¥ÌÜµ</label>
                              </div>
                              <div class="likert-item">
                                  <input type="radio" name="support${characterCount}" id="support${characterCount}_support" value="ÏßÄÏßÄ">
                                  <label for="support${characterCount}_support">ÏßÄÏßÄ</label>
                              </div>
                              <div class="likert-item">
                                  <input type="radio" name="support${characterCount}" id="support${characterCount}_very_support" value="Îß§Ïö∞ ÏßÄÏßÄ">
                                  <label for="support${characterCount}_very_support">Îß§Ïö∞ ÏßÄÏßÄ</label>
                              </div>
                          </div>
                      `;
                  } else if (index === 3) { // Ïù∏Î¨º ÌäπÏßï
                      newCell.innerHTML = '<input type="text" placeholder="Ïù∏Î¨ºÏùò ÌäπÏßï" value="">';
                  } else if (index === 4) { // Ï£ºÏù∏Í≥µÏóêÍ≤å Ï§Ä ÏòÅÌñ•
                      newCell.innerHTML = '<input type="text" placeholder="ÎØ∏Ïπú ÏòÅÌñ•" value="">';
                  }
                  
                  row.appendChild(newCell);
              });
          }
          
          function removeCharacter(characterNumber) {
              const table = document.getElementById('characters-table');
              const tbody = table.querySelector('tbody');
              const thead = table.querySelector('thead tr');
              
              // ÏµúÏÜå 1Î™ÖÏùÄ Ïú†ÏßÄ
              const currentColumns = thead.querySelectorAll('th').length;
              if (currentColumns <= 2) {
                  alert('ÏµúÏÜå 1Î™ÖÏùò Ï£ºÎ≥Ä Ïù∏Î¨ºÏùÄ Ïú†ÏßÄÌï¥Ïïº Ìï©ÎãàÎã§.');
                  return;
              }
              
              // Ìó§ÎçîÏóêÏÑú Ìï¥Îãπ Ïª¨Îüº Ï†úÍ±∞
              const headerCells = thead.querySelectorAll('th');
              headerCells[characterNumber].remove();
              
              // Í∞Å ÌñâÏóêÏÑú Ìï¥Îãπ Ïª¨Îüº Ï†úÍ±∞
              const rows = tbody.querySelectorAll('tr');
              rows.forEach(row => {
                  const cells = row.querySelectorAll('td');
                  if (cells[characterNumber]) {
                      cells[characterNumber].remove();
                  }
              });
              
              // Î≤àÌò∏ Ïû¨Ï†ïÎ†¨
              const remainingHeaders = thead.querySelectorAll('th');
              remainingHeaders.forEach((header, index) => {
                  if (index > 0) { // Ï≤´ Î≤àÏß∏ Ìó§Îçî(Ìï≠Î™©)Îäî Ï†úÏô∏
                      const button = header.querySelector('button');
                      if (button) {
                          button.onclick = () => removeCharacter(index);
                      }
                  }
              });
          }

          // Ïπ®ÏäµÏ†Å Î∞òÏ∂î ÏûÖÎ†• ÌïÑÎìú ÌÜ†Í∏Ä Í∏∞Îä•
          function toggleIntrusiveInput() {
              const yesInput = document.getElementById('intrusive_yes_input');
              const noInput = document.getElementById('intrusive_no_input');
              const yesRadio = document.getElementById('intrusive_yes');
              const noRadio = document.getElementById('intrusive_no');
              
              if (yesRadio.checked) {
                  yesInput.style.display = 'block';
                  noInput.style.display = 'none';
              } else if (noRadio.checked) {
                  yesInput.style.display = 'none';
                  noInput.style.display = 'block';
              } else {
                  yesInput.style.display = 'none';
                  noInput.style.display = 'none';
              }
          }


     </script>
</body>
</html>


